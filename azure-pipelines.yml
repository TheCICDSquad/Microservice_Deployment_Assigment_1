trigger:
- main

pool:
  name: 'Linux_Agent'  # Your pool with Python 3.12.3

steps:
# 1. Create virtual environment (no sudo needed)
- script: |
    python3.12 -m venv .venv --without-pip
    source .venv/bin/activate
    
    # Install pip manually
    curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
    python3.12 get-pip.py --user
    rm get-pip.py
  displayName: 'Create virtual environment'

# 2. Install dependencies and run app
- script: |
    source .venv/bin/activate
    cd app  # or your correct path
    
    # Install requirements
    python3.12 -m pip install -r requirements.txt
    
    # Run application
    python3.12 main.py
  displayName: 'Run FastAPI application'

# 2. Docker build (only if you need it)
- task: Docker@2
  displayName: 'Build Docker image'
  inputs:
    command: 'build'
    repository: 'your-app-name'
    dockerfile: 'Microservice_Deployment_Assigment_1/app/Dockerfile'
    tags: 'latest'