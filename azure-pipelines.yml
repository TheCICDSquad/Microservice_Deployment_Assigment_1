trigger:
- main

pool:
  name: 'Linux_Agent'  # Your pool with Python 3.12.3

steps:
# 1. Install required system packages
- script: |
    sudo apt-get update
    sudo apt-get install -y python3.12-venv
  displayName: 'Install Python venv module'

# 2. Create and use virtual environment
- script: |
    python3.12 -m venv .venv
    source .venv/bin/activate
    python -m pip install --upgrade pip
    
    # Navigate to app directory and install requirements
    cd Microservice_Deployment_Assigment_1/app
    pip install -r requirements.txt
    python main.py
  displayName: 'Run application in virtual environment'
  env:
    DEBIAN_FRONTEND: noninteractive

# 2. Docker build (only if you need it)
- task: Docker@2
  displayName: 'Build Docker image'
  inputs:
    command: 'build'
    repository: 'your-app-name'
    dockerfile: 'Microservice_Deployment_Assigment_1/app/Dockerfile'
    tags: 'latest'